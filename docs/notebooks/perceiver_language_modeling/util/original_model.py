import pickle
from jax import numpy as jnp
import haiku as hk
from flax.core import freeze
from flax.traverse_util import unflatten_dict

PARAM_MAP = {
    "perceiver_encoder/~/cross_attention/attention/linear_3:w": "params/PerceiverIO/Encoder/CrossAttentionBlock_0/Attention_0/out/kernel",
    "perceiver_encoder/~/cross_attention/mlp/linear:w": "params/PerceiverIO/Encoder/CrossAttentionBlock_0/FeedForward_0/Dense_0/kernel",
    "perceiver_encoder/~/cross_attention/mlp/linear_1:w": "params/PerceiverIO/Encoder/CrossAttentionBlock_0/FeedForward_0/Dense_1/kernel",
    "perceiver_encoder/~/self_attention/attention/linear_2:w": "params/PerceiverIO/Processor/SelfAttentionBlock_0/SelfAttention_0/value/kernel",
    "perceiver_encoder/~/self_attention/attention/linear_3:w": "params/PerceiverIO/Processor/SelfAttentionBlock_0/SelfAttention_0/out/kernel",
    "perceiver_encoder/~/self_attention/mlp/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_0/FeedForward_0/Dense_0/kernel",
    "perceiver_encoder/~/self_attention/mlp/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_0/FeedForward_0/Dense_1/kernel",
    "perceiver_encoder/~/self_attention_1/attention/linear_2:w": "params/PerceiverIO/Processor/SelfAttentionBlock_1/SelfAttention_0/value/kernel",
    "perceiver_encoder/~/self_attention_1/attention/linear_3:w": "params/PerceiverIO/Processor/SelfAttentionBlock_1/SelfAttention_0/out/kernel",
    "perceiver_encoder/~/self_attention_1/mlp/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_1/FeedForward_0/Dense_0/kernel",
    "perceiver_encoder/~/self_attention_1/mlp/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_1/FeedForward_0/Dense_1/kernel",
    "perceiver_encoder/~/self_attention_10/attention/linear_2:w": "params/PerceiverIO/Processor/SelfAttentionBlock_10/SelfAttention_0/value/kernel",
    "perceiver_encoder/~/self_attention_10/attention/linear_3:w": "params/PerceiverIO/Processor/SelfAttentionBlock_10/SelfAttention_0/out/kernel",
    "perceiver_encoder/~/self_attention_10/mlp/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_10/FeedForward_0/Dense_0/kernel",
    "perceiver_encoder/~/self_attention_10/mlp/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_10/FeedForward_0/Dense_1/kernel",
    "perceiver_encoder/~/self_attention_11/attention/linear_2:w": "params/PerceiverIO/Processor/SelfAttentionBlock_11/SelfAttention_0/value/kernel",
    "perceiver_encoder/~/self_attention_11/attention/linear_3:w": "params/PerceiverIO/Processor/SelfAttentionBlock_11/SelfAttention_0/out/kernel",
    "perceiver_encoder/~/self_attention_11/mlp/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_11/FeedForward_0/Dense_0/kernel",
    "perceiver_encoder/~/self_attention_11/mlp/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_11/FeedForward_0/Dense_1/kernel",
    "perceiver_encoder/~/self_attention_12/attention/linear_2:w": "params/PerceiverIO/Processor/SelfAttentionBlock_12/SelfAttention_0/value/kernel",
    "perceiver_encoder/~/self_attention_12/attention/linear_3:w": "params/PerceiverIO/Processor/SelfAttentionBlock_12/SelfAttention_0/out/kernel",
    "perceiver_encoder/~/self_attention_12/mlp/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_12/FeedForward_0/Dense_0/kernel",
    "perceiver_encoder/~/self_attention_12/mlp/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_12/FeedForward_0/Dense_1/kernel",
    "perceiver_encoder/~/self_attention_13/attention/linear_2:w": "params/PerceiverIO/Processor/SelfAttentionBlock_13/SelfAttention_0/value/kernel",
    "perceiver_encoder/~/self_attention_13/attention/linear_3:w": "params/PerceiverIO/Processor/SelfAttentionBlock_13/SelfAttention_0/out/kernel",
    "perceiver_encoder/~/self_attention_13/mlp/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_13/FeedForward_0/Dense_0/kernel",
    "perceiver_encoder/~/self_attention_13/mlp/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_13/FeedForward_0/Dense_1/kernel",
    "perceiver_encoder/~/self_attention_14/attention/linear_2:w": "params/PerceiverIO/Processor/SelfAttentionBlock_14/SelfAttention_0/value/kernel",
    "perceiver_encoder/~/self_attention_14/attention/linear_3:w": "params/PerceiverIO/Processor/SelfAttentionBlock_14/SelfAttention_0/out/kernel",
    "perceiver_encoder/~/self_attention_14/mlp/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_14/FeedForward_0/Dense_0/kernel",
    "perceiver_encoder/~/self_attention_14/mlp/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_14/FeedForward_0/Dense_1/kernel",
    "perceiver_encoder/~/self_attention_15/attention/linear_2:w": "params/PerceiverIO/Processor/SelfAttentionBlock_15/SelfAttention_0/value/kernel",
    "perceiver_encoder/~/self_attention_15/attention/linear_3:w": "params/PerceiverIO/Processor/SelfAttentionBlock_15/SelfAttention_0/out/kernel",
    "perceiver_encoder/~/self_attention_15/mlp/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_15/FeedForward_0/Dense_0/kernel",
    "perceiver_encoder/~/self_attention_15/mlp/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_15/FeedForward_0/Dense_1/kernel",
    "perceiver_encoder/~/self_attention_16/attention/linear_2:w": "params/PerceiverIO/Processor/SelfAttentionBlock_16/SelfAttention_0/value/kernel",
    "perceiver_encoder/~/self_attention_16/attention/linear_3:w": "params/PerceiverIO/Processor/SelfAttentionBlock_16/SelfAttention_0/out/kernel",
    "perceiver_encoder/~/self_attention_16/mlp/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_16/FeedForward_0/Dense_0/kernel",
    "perceiver_encoder/~/self_attention_16/mlp/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_16/FeedForward_0/Dense_1/kernel",
    "perceiver_encoder/~/self_attention_17/attention/linear_2:w": "params/PerceiverIO/Processor/SelfAttentionBlock_17/SelfAttention_0/value/kernel",
    "perceiver_encoder/~/self_attention_17/attention/linear_3:w": "params/PerceiverIO/Processor/SelfAttentionBlock_17/SelfAttention_0/out/kernel",
    "perceiver_encoder/~/self_attention_17/mlp/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_17/FeedForward_0/Dense_0/kernel",
    "perceiver_encoder/~/self_attention_17/mlp/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_17/FeedForward_0/Dense_1/kernel",
    "perceiver_encoder/~/self_attention_18/attention/linear_2:w": "params/PerceiverIO/Processor/SelfAttentionBlock_18/SelfAttention_0/value/kernel",
    "perceiver_encoder/~/self_attention_18/attention/linear_3:w": "params/PerceiverIO/Processor/SelfAttentionBlock_18/SelfAttention_0/out/kernel",
    "perceiver_encoder/~/self_attention_18/mlp/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_18/FeedForward_0/Dense_0/kernel",
    "perceiver_encoder/~/self_attention_18/mlp/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_18/FeedForward_0/Dense_1/kernel",
    "perceiver_encoder/~/self_attention_19/attention/linear_2:w": "params/PerceiverIO/Processor/SelfAttentionBlock_19/SelfAttention_0/value/kernel",
    "perceiver_encoder/~/self_attention_19/attention/linear_3:w": "params/PerceiverIO/Processor/SelfAttentionBlock_19/SelfAttention_0/out/kernel",
    "perceiver_encoder/~/self_attention_19/mlp/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_19/FeedForward_0/Dense_0/kernel",
    "perceiver_encoder/~/self_attention_19/mlp/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_19/FeedForward_0/Dense_1/kernel",
    "perceiver_encoder/~/self_attention_2/attention/linear_2:w": "params/PerceiverIO/Processor/SelfAttentionBlock_2/SelfAttention_0/value/kernel",
    "perceiver_encoder/~/self_attention_2/attention/linear_3:w": "params/PerceiverIO/Processor/SelfAttentionBlock_2/SelfAttention_0/out/kernel",
    "perceiver_encoder/~/self_attention_2/mlp/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_2/FeedForward_0/Dense_0/kernel",
    "perceiver_encoder/~/self_attention_2/mlp/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_2/FeedForward_0/Dense_1/kernel",
    "perceiver_encoder/~/self_attention_20/attention/linear_2:w": "params/PerceiverIO/Processor/SelfAttentionBlock_20/SelfAttention_0/value/kernel",
    "perceiver_encoder/~/self_attention_20/attention/linear_3:w": "params/PerceiverIO/Processor/SelfAttentionBlock_20/SelfAttention_0/out/kernel",
    "perceiver_encoder/~/self_attention_20/mlp/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_20/FeedForward_0/Dense_0/kernel",
    "perceiver_encoder/~/self_attention_20/mlp/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_20/FeedForward_0/Dense_1/kernel",
    "perceiver_encoder/~/self_attention_21/attention/linear_2:w": "params/PerceiverIO/Processor/SelfAttentionBlock_21/SelfAttention_0/value/kernel",
    "perceiver_encoder/~/self_attention_21/attention/linear_3:w": "params/PerceiverIO/Processor/SelfAttentionBlock_21/SelfAttention_0/out/kernel",
    "perceiver_encoder/~/self_attention_21/mlp/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_21/FeedForward_0/Dense_0/kernel",
    "perceiver_encoder/~/self_attention_21/mlp/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_21/FeedForward_0/Dense_1/kernel",
    "perceiver_encoder/~/self_attention_22/attention/linear_2:w": "params/PerceiverIO/Processor/SelfAttentionBlock_22/SelfAttention_0/value/kernel",
    "perceiver_encoder/~/self_attention_22/attention/linear_3:w": "params/PerceiverIO/Processor/SelfAttentionBlock_22/SelfAttention_0/out/kernel",
    "perceiver_encoder/~/self_attention_22/mlp/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_22/FeedForward_0/Dense_0/kernel",
    "perceiver_encoder/~/self_attention_22/mlp/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_22/FeedForward_0/Dense_1/kernel",
    "perceiver_encoder/~/self_attention_23/attention/linear_2:w": "params/PerceiverIO/Processor/SelfAttentionBlock_23/SelfAttention_0/value/kernel",
    "perceiver_encoder/~/self_attention_23/attention/linear_3:w": "params/PerceiverIO/Processor/SelfAttentionBlock_23/SelfAttention_0/out/kernel",
    "perceiver_encoder/~/self_attention_23/mlp/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_23/FeedForward_0/Dense_0/kernel",
    "perceiver_encoder/~/self_attention_23/mlp/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_23/FeedForward_0/Dense_1/kernel",
    "perceiver_encoder/~/self_attention_24/attention/linear_2:w": "params/PerceiverIO/Processor/SelfAttentionBlock_24/SelfAttention_0/value/kernel",
    "perceiver_encoder/~/self_attention_24/attention/linear_3:w": "params/PerceiverIO/Processor/SelfAttentionBlock_24/SelfAttention_0/out/kernel",
    "perceiver_encoder/~/self_attention_24/mlp/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_24/FeedForward_0/Dense_0/kernel",
    "perceiver_encoder/~/self_attention_24/mlp/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_24/FeedForward_0/Dense_1/kernel",
    "perceiver_encoder/~/self_attention_25/attention/linear_2:w": "params/PerceiverIO/Processor/SelfAttentionBlock_25/SelfAttention_0/value/kernel",
    "perceiver_encoder/~/self_attention_25/attention/linear_3:w": "params/PerceiverIO/Processor/SelfAttentionBlock_25/SelfAttention_0/out/kernel",
    "perceiver_encoder/~/self_attention_25/mlp/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_25/FeedForward_0/Dense_0/kernel",
    "perceiver_encoder/~/self_attention_25/mlp/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_25/FeedForward_0/Dense_1/kernel",
    "perceiver_encoder/~/self_attention_3/attention/linear_2:w": "params/PerceiverIO/Processor/SelfAttentionBlock_3/SelfAttention_0/value/kernel",
    "perceiver_encoder/~/self_attention_3/attention/linear_3:w": "params/PerceiverIO/Processor/SelfAttentionBlock_3/SelfAttention_0/out/kernel",
    "perceiver_encoder/~/self_attention_3/mlp/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_3/FeedForward_0/Dense_0/kernel",
    "perceiver_encoder/~/self_attention_3/mlp/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_3/FeedForward_0/Dense_1/kernel",
    "perceiver_encoder/~/self_attention_4/attention/linear_2:w": "params/PerceiverIO/Processor/SelfAttentionBlock_4/SelfAttention_0/value/kernel",
    "perceiver_encoder/~/self_attention_4/attention/linear_3:w": "params/PerceiverIO/Processor/SelfAttentionBlock_4/SelfAttention_0/out/kernel",
    "perceiver_encoder/~/self_attention_4/mlp/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_4/FeedForward_0/Dense_0/kernel",
    "perceiver_encoder/~/self_attention_4/mlp/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_4/FeedForward_0/Dense_1/kernel",
    "perceiver_encoder/~/self_attention_5/attention/linear_2:w": "params/PerceiverIO/Processor/SelfAttentionBlock_5/SelfAttention_0/value/kernel",
    "perceiver_encoder/~/self_attention_5/attention/linear_3:w": "params/PerceiverIO/Processor/SelfAttentionBlock_5/SelfAttention_0/out/kernel",
    "perceiver_encoder/~/self_attention_5/mlp/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_5/FeedForward_0/Dense_0/kernel",
    "perceiver_encoder/~/self_attention_5/mlp/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_5/FeedForward_0/Dense_1/kernel",
    "perceiver_encoder/~/self_attention_6/attention/linear_2:w": "params/PerceiverIO/Processor/SelfAttentionBlock_6/SelfAttention_0/value/kernel",
    "perceiver_encoder/~/self_attention_6/attention/linear_3:w": "params/PerceiverIO/Processor/SelfAttentionBlock_6/SelfAttention_0/out/kernel",
    "perceiver_encoder/~/self_attention_6/mlp/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_6/FeedForward_0/Dense_0/kernel",
    "perceiver_encoder/~/self_attention_6/mlp/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_6/FeedForward_0/Dense_1/kernel",
    "perceiver_encoder/~/self_attention_7/attention/linear_2:w": "params/PerceiverIO/Processor/SelfAttentionBlock_7/SelfAttention_0/value/kernel",
    "perceiver_encoder/~/self_attention_7/attention/linear_3:w": "params/PerceiverIO/Processor/SelfAttentionBlock_7/SelfAttention_0/out/kernel",
    "perceiver_encoder/~/self_attention_7/mlp/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_7/FeedForward_0/Dense_0/kernel",
    "perceiver_encoder/~/self_attention_7/mlp/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_7/FeedForward_0/Dense_1/kernel",
    "perceiver_encoder/~/self_attention_8/attention/linear_2:w": "params/PerceiverIO/Processor/SelfAttentionBlock_8/SelfAttention_0/value/kernel",
    "perceiver_encoder/~/self_attention_8/attention/linear_3:w": "params/PerceiverIO/Processor/SelfAttentionBlock_8/SelfAttention_0/out/kernel",
    "perceiver_encoder/~/self_attention_8/mlp/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_8/FeedForward_0/Dense_0/kernel",
    "perceiver_encoder/~/self_attention_8/mlp/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_8/FeedForward_0/Dense_1/kernel",
    "perceiver_encoder/~/self_attention_9/attention/linear_2:w": "params/PerceiverIO/Processor/SelfAttentionBlock_9/SelfAttention_0/value/kernel",
    "perceiver_encoder/~/self_attention_9/attention/linear_3:w": "params/PerceiverIO/Processor/SelfAttentionBlock_9/SelfAttention_0/out/kernel",
    "perceiver_encoder/~/self_attention_9/mlp/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_9/FeedForward_0/Dense_0/kernel",
    "perceiver_encoder/~/self_attention_9/mlp/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_9/FeedForward_0/Dense_1/kernel",
    "basic_decoder/cross_attention/attention/linear_1:w": "params/PerceiverIO/Decoder/CrossAttentionBlock_0/Attention_0/key/kernel",
    "perceiver_encoder/~/cross_attention/attention/linear:w": "params/PerceiverIO/Encoder/CrossAttentionBlock_0/Attention_0/query/kernel",
    "perceiver_encoder/~/self_attention/attention/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_0/SelfAttention_0/query/kernel",
    "perceiver_encoder/~/self_attention/attention/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_0/SelfAttention_0/key/kernel",
    "perceiver_encoder/~/self_attention_1/attention/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_1/SelfAttention_0/query/kernel",
    "perceiver_encoder/~/self_attention_1/attention/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_1/SelfAttention_0/key/kernel",
    "perceiver_encoder/~/self_attention_10/attention/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_10/SelfAttention_0/query/kernel",
    "perceiver_encoder/~/self_attention_10/attention/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_10/SelfAttention_0/key/kernel",
    "perceiver_encoder/~/self_attention_11/attention/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_11/SelfAttention_0/query/kernel",
    "perceiver_encoder/~/self_attention_11/attention/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_11/SelfAttention_0/key/kernel",
    "perceiver_encoder/~/self_attention_12/attention/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_12/SelfAttention_0/query/kernel",
    "perceiver_encoder/~/self_attention_12/attention/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_12/SelfAttention_0/key/kernel",
    "perceiver_encoder/~/self_attention_13/attention/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_13/SelfAttention_0/query/kernel",
    "perceiver_encoder/~/self_attention_13/attention/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_13/SelfAttention_0/key/kernel",
    "perceiver_encoder/~/self_attention_14/attention/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_14/SelfAttention_0/query/kernel",
    "perceiver_encoder/~/self_attention_14/attention/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_14/SelfAttention_0/key/kernel",
    "perceiver_encoder/~/self_attention_15/attention/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_15/SelfAttention_0/query/kernel",
    "perceiver_encoder/~/self_attention_15/attention/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_15/SelfAttention_0/key/kernel",
    "perceiver_encoder/~/self_attention_16/attention/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_16/SelfAttention_0/query/kernel",
    "perceiver_encoder/~/self_attention_16/attention/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_16/SelfAttention_0/key/kernel",
    "perceiver_encoder/~/self_attention_17/attention/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_17/SelfAttention_0/query/kernel",
    "perceiver_encoder/~/self_attention_17/attention/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_17/SelfAttention_0/key/kernel",
    "perceiver_encoder/~/self_attention_18/attention/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_18/SelfAttention_0/query/kernel",
    "perceiver_encoder/~/self_attention_18/attention/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_18/SelfAttention_0/key/kernel",
    "perceiver_encoder/~/self_attention_19/attention/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_19/SelfAttention_0/query/kernel",
    "perceiver_encoder/~/self_attention_19/attention/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_19/SelfAttention_0/key/kernel",
    "perceiver_encoder/~/self_attention_2/attention/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_2/SelfAttention_0/query/kernel",
    "perceiver_encoder/~/self_attention_2/attention/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_2/SelfAttention_0/key/kernel",
    "perceiver_encoder/~/self_attention_20/attention/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_20/SelfAttention_0/query/kernel",
    "perceiver_encoder/~/self_attention_20/attention/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_20/SelfAttention_0/key/kernel",
    "perceiver_encoder/~/self_attention_21/attention/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_21/SelfAttention_0/query/kernel",
    "perceiver_encoder/~/self_attention_21/attention/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_21/SelfAttention_0/key/kernel",
    "perceiver_encoder/~/self_attention_22/attention/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_22/SelfAttention_0/query/kernel",
    "perceiver_encoder/~/self_attention_22/attention/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_22/SelfAttention_0/key/kernel",
    "perceiver_encoder/~/self_attention_23/attention/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_23/SelfAttention_0/query/kernel",
    "perceiver_encoder/~/self_attention_23/attention/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_23/SelfAttention_0/key/kernel",
    "perceiver_encoder/~/self_attention_24/attention/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_24/SelfAttention_0/query/kernel",
    "perceiver_encoder/~/self_attention_24/attention/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_24/SelfAttention_0/key/kernel",
    "perceiver_encoder/~/self_attention_25/attention/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_25/SelfAttention_0/query/kernel",
    "perceiver_encoder/~/self_attention_25/attention/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_25/SelfAttention_0/key/kernel",
    "perceiver_encoder/~/self_attention_3/attention/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_3/SelfAttention_0/query/kernel",
    "perceiver_encoder/~/self_attention_3/attention/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_3/SelfAttention_0/key/kernel",
    "perceiver_encoder/~/self_attention_4/attention/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_4/SelfAttention_0/query/kernel",
    "perceiver_encoder/~/self_attention_4/attention/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_4/SelfAttention_0/key/kernel",
    "perceiver_encoder/~/self_attention_5/attention/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_5/SelfAttention_0/query/kernel",
    "perceiver_encoder/~/self_attention_5/attention/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_5/SelfAttention_0/key/kernel",
    "perceiver_encoder/~/self_attention_6/attention/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_6/SelfAttention_0/query/kernel",
    "perceiver_encoder/~/self_attention_6/attention/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_6/SelfAttention_0/key/kernel",
    "perceiver_encoder/~/self_attention_7/attention/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_7/SelfAttention_0/query/kernel",
    "perceiver_encoder/~/self_attention_7/attention/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_7/SelfAttention_0/key/kernel",
    "perceiver_encoder/~/self_attention_8/attention/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_8/SelfAttention_0/query/kernel",
    "perceiver_encoder/~/self_attention_8/attention/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_8/SelfAttention_0/key/kernel",
    "perceiver_encoder/~/self_attention_9/attention/linear:w": "params/PerceiverIO/Processor/SelfAttentionBlock_9/SelfAttention_0/query/kernel",
    "perceiver_encoder/~/self_attention_9/attention/linear_1:w": "params/PerceiverIO/Processor/SelfAttentionBlock_9/SelfAttention_0/key/kernel",
    "basic_decoder/cross_attention/attention/linear_2:w": "params/PerceiverIO/Decoder/CrossAttentionBlock_0/Attention_0/value/kernel",
    "basic_decoder/cross_attention/layer_norm_1:offset": "params/PerceiverIO/Decoder/CrossAttentionBlock_0/LayerNorm_1/bias",
    "basic_decoder/cross_attention/layer_norm_1:scale": "params/PerceiverIO/Decoder/CrossAttentionBlock_0/LayerNorm_1/scale",
    "perceiver_encoder/~/cross_attention/attention/linear_2:b": "params/PerceiverIO/Encoder/CrossAttentionBlock_0/Attention_0/value/bias",
    "perceiver_encoder/~/cross_attention/attention/linear_3:b": "params/PerceiverIO/Encoder/CrossAttentionBlock_0/Attention_0/out/bias",
    "perceiver_encoder/~/cross_attention/layer_norm:offset": "params/PerceiverIO/Encoder/CrossAttentionBlock_0/LayerNorm_0/bias",
    "perceiver_encoder/~/cross_attention/layer_norm:scale": "params/PerceiverIO/Encoder/CrossAttentionBlock_0/LayerNorm_0/scale",
    "perceiver_encoder/~/cross_attention/layer_norm_2:offset": "params/PerceiverIO/Encoder/CrossAttentionBlock_0/LayerNorm_2/bias",
    "perceiver_encoder/~/cross_attention/layer_norm_2:scale": "params/PerceiverIO/Encoder/CrossAttentionBlock_0/LayerNorm_2/scale",
    "perceiver_encoder/~/cross_attention/mlp/linear:b": "params/PerceiverIO/Encoder/CrossAttentionBlock_0/FeedForward_0/Dense_0/bias",
    "perceiver_encoder/~/cross_attention/mlp/linear_1:b": "params/PerceiverIO/Encoder/CrossAttentionBlock_0/FeedForward_0/Dense_1/bias",
    "perceiver_encoder/~/self_attention/attention/linear_2:b": "params/PerceiverIO/Processor/SelfAttentionBlock_0/SelfAttention_0/value/bias",
    "perceiver_encoder/~/self_attention/attention/linear_3:b": "params/PerceiverIO/Processor/SelfAttentionBlock_0/SelfAttention_0/out/bias",
    "perceiver_encoder/~/self_attention/layer_norm:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_0/LayerNorm_0/bias",
    "perceiver_encoder/~/self_attention/layer_norm:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_0/LayerNorm_0/scale",
    "perceiver_encoder/~/self_attention/layer_norm_1:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_0/LayerNorm_1/bias",
    "perceiver_encoder/~/self_attention/layer_norm_1:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_0/LayerNorm_1/scale",
    "perceiver_encoder/~/self_attention/mlp/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_0/FeedForward_0/Dense_0/bias",
    "perceiver_encoder/~/self_attention/mlp/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_0/FeedForward_0/Dense_1/bias",
    "perceiver_encoder/~/self_attention_1/attention/linear_2:b": "params/PerceiverIO/Processor/SelfAttentionBlock_1/SelfAttention_0/value/bias",
    "perceiver_encoder/~/self_attention_1/attention/linear_3:b": "params/PerceiverIO/Processor/SelfAttentionBlock_1/SelfAttention_0/out/bias",
    "perceiver_encoder/~/self_attention_1/layer_norm:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_1/LayerNorm_0/bias",
    "perceiver_encoder/~/self_attention_1/layer_norm:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_1/LayerNorm_0/scale",
    "perceiver_encoder/~/self_attention_1/layer_norm_1:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_1/LayerNorm_1/bias",
    "perceiver_encoder/~/self_attention_1/layer_norm_1:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_1/LayerNorm_1/scale",
    "perceiver_encoder/~/self_attention_1/mlp/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_1/FeedForward_0/Dense_0/bias",
    "perceiver_encoder/~/self_attention_1/mlp/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_1/FeedForward_0/Dense_1/bias",
    "perceiver_encoder/~/self_attention_10/attention/linear_2:b": "params/PerceiverIO/Processor/SelfAttentionBlock_10/SelfAttention_0/value/bias",
    "perceiver_encoder/~/self_attention_10/attention/linear_3:b": "params/PerceiverIO/Processor/SelfAttentionBlock_10/SelfAttention_0/out/bias",
    "perceiver_encoder/~/self_attention_10/layer_norm:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_10/LayerNorm_0/bias",
    "perceiver_encoder/~/self_attention_10/layer_norm:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_10/LayerNorm_0/scale",
    "perceiver_encoder/~/self_attention_10/layer_norm_1:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_10/LayerNorm_1/bias",
    "perceiver_encoder/~/self_attention_10/layer_norm_1:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_10/LayerNorm_1/scale",
    "perceiver_encoder/~/self_attention_10/mlp/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_10/FeedForward_0/Dense_0/bias",
    "perceiver_encoder/~/self_attention_10/mlp/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_10/FeedForward_0/Dense_1/bias",
    "perceiver_encoder/~/self_attention_11/attention/linear_2:b": "params/PerceiverIO/Processor/SelfAttentionBlock_11/SelfAttention_0/value/bias",
    "perceiver_encoder/~/self_attention_11/attention/linear_3:b": "params/PerceiverIO/Processor/SelfAttentionBlock_11/SelfAttention_0/out/bias",
    "perceiver_encoder/~/self_attention_11/layer_norm:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_11/LayerNorm_0/bias",
    "perceiver_encoder/~/self_attention_11/layer_norm:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_11/LayerNorm_0/scale",
    "perceiver_encoder/~/self_attention_11/layer_norm_1:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_11/LayerNorm_1/bias",
    "perceiver_encoder/~/self_attention_11/layer_norm_1:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_11/LayerNorm_1/scale",
    "perceiver_encoder/~/self_attention_11/mlp/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_11/FeedForward_0/Dense_0/bias",
    "perceiver_encoder/~/self_attention_11/mlp/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_11/FeedForward_0/Dense_1/bias",
    "perceiver_encoder/~/self_attention_12/attention/linear_2:b": "params/PerceiverIO/Processor/SelfAttentionBlock_12/SelfAttention_0/value/bias",
    "perceiver_encoder/~/self_attention_12/attention/linear_3:b": "params/PerceiverIO/Processor/SelfAttentionBlock_12/SelfAttention_0/out/bias",
    "perceiver_encoder/~/self_attention_12/layer_norm:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_12/LayerNorm_0/bias",
    "perceiver_encoder/~/self_attention_12/layer_norm:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_12/LayerNorm_0/scale",
    "perceiver_encoder/~/self_attention_12/layer_norm_1:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_12/LayerNorm_1/bias",
    "perceiver_encoder/~/self_attention_12/layer_norm_1:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_12/LayerNorm_1/scale",
    "perceiver_encoder/~/self_attention_12/mlp/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_12/FeedForward_0/Dense_0/bias",
    "perceiver_encoder/~/self_attention_12/mlp/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_12/FeedForward_0/Dense_1/bias",
    "perceiver_encoder/~/self_attention_13/attention/linear_2:b": "params/PerceiverIO/Processor/SelfAttentionBlock_13/SelfAttention_0/value/bias",
    "perceiver_encoder/~/self_attention_13/attention/linear_3:b": "params/PerceiverIO/Processor/SelfAttentionBlock_13/SelfAttention_0/out/bias",
    "perceiver_encoder/~/self_attention_13/layer_norm:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_13/LayerNorm_0/bias",
    "perceiver_encoder/~/self_attention_13/layer_norm:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_13/LayerNorm_0/scale",
    "perceiver_encoder/~/self_attention_13/layer_norm_1:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_13/LayerNorm_1/bias",
    "perceiver_encoder/~/self_attention_13/layer_norm_1:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_13/LayerNorm_1/scale",
    "perceiver_encoder/~/self_attention_13/mlp/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_13/FeedForward_0/Dense_0/bias",
    "perceiver_encoder/~/self_attention_13/mlp/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_13/FeedForward_0/Dense_1/bias",
    "perceiver_encoder/~/self_attention_14/attention/linear_2:b": "params/PerceiverIO/Processor/SelfAttentionBlock_14/SelfAttention_0/value/bias",
    "perceiver_encoder/~/self_attention_14/attention/linear_3:b": "params/PerceiverIO/Processor/SelfAttentionBlock_14/SelfAttention_0/out/bias",
    "perceiver_encoder/~/self_attention_14/layer_norm:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_14/LayerNorm_0/bias",
    "perceiver_encoder/~/self_attention_14/layer_norm:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_14/LayerNorm_0/scale",
    "perceiver_encoder/~/self_attention_14/layer_norm_1:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_14/LayerNorm_1/bias",
    "perceiver_encoder/~/self_attention_14/layer_norm_1:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_14/LayerNorm_1/scale",
    "perceiver_encoder/~/self_attention_14/mlp/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_14/FeedForward_0/Dense_0/bias",
    "perceiver_encoder/~/self_attention_14/mlp/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_14/FeedForward_0/Dense_1/bias",
    "perceiver_encoder/~/self_attention_15/attention/linear_2:b": "params/PerceiverIO/Processor/SelfAttentionBlock_15/SelfAttention_0/value/bias",
    "perceiver_encoder/~/self_attention_15/attention/linear_3:b": "params/PerceiverIO/Processor/SelfAttentionBlock_15/SelfAttention_0/out/bias",
    "perceiver_encoder/~/self_attention_15/layer_norm:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_15/LayerNorm_0/bias",
    "perceiver_encoder/~/self_attention_15/layer_norm:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_15/LayerNorm_0/scale",
    "perceiver_encoder/~/self_attention_15/layer_norm_1:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_15/LayerNorm_1/bias",
    "perceiver_encoder/~/self_attention_15/layer_norm_1:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_15/LayerNorm_1/scale",
    "perceiver_encoder/~/self_attention_15/mlp/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_15/FeedForward_0/Dense_0/bias",
    "perceiver_encoder/~/self_attention_15/mlp/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_15/FeedForward_0/Dense_1/bias",
    "perceiver_encoder/~/self_attention_16/attention/linear_2:b": "params/PerceiverIO/Processor/SelfAttentionBlock_16/SelfAttention_0/value/bias",
    "perceiver_encoder/~/self_attention_16/attention/linear_3:b": "params/PerceiverIO/Processor/SelfAttentionBlock_16/SelfAttention_0/out/bias",
    "perceiver_encoder/~/self_attention_16/layer_norm:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_16/LayerNorm_0/bias",
    "perceiver_encoder/~/self_attention_16/layer_norm:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_16/LayerNorm_0/scale",
    "perceiver_encoder/~/self_attention_16/layer_norm_1:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_16/LayerNorm_1/bias",
    "perceiver_encoder/~/self_attention_16/layer_norm_1:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_16/LayerNorm_1/scale",
    "perceiver_encoder/~/self_attention_16/mlp/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_16/FeedForward_0/Dense_0/bias",
    "perceiver_encoder/~/self_attention_16/mlp/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_16/FeedForward_0/Dense_1/bias",
    "perceiver_encoder/~/self_attention_17/attention/linear_2:b": "params/PerceiverIO/Processor/SelfAttentionBlock_17/SelfAttention_0/value/bias",
    "perceiver_encoder/~/self_attention_17/attention/linear_3:b": "params/PerceiverIO/Processor/SelfAttentionBlock_17/SelfAttention_0/out/bias",
    "perceiver_encoder/~/self_attention_17/layer_norm:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_17/LayerNorm_0/bias",
    "perceiver_encoder/~/self_attention_17/layer_norm:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_17/LayerNorm_0/scale",
    "perceiver_encoder/~/self_attention_17/layer_norm_1:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_17/LayerNorm_1/bias",
    "perceiver_encoder/~/self_attention_17/layer_norm_1:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_17/LayerNorm_1/scale",
    "perceiver_encoder/~/self_attention_17/mlp/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_17/FeedForward_0/Dense_0/bias",
    "perceiver_encoder/~/self_attention_17/mlp/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_17/FeedForward_0/Dense_1/bias",
    "perceiver_encoder/~/self_attention_18/attention/linear_2:b": "params/PerceiverIO/Processor/SelfAttentionBlock_18/SelfAttention_0/value/bias",
    "perceiver_encoder/~/self_attention_18/attention/linear_3:b": "params/PerceiverIO/Processor/SelfAttentionBlock_18/SelfAttention_0/out/bias",
    "perceiver_encoder/~/self_attention_18/layer_norm:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_18/LayerNorm_0/bias",
    "perceiver_encoder/~/self_attention_18/layer_norm:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_18/LayerNorm_0/scale",
    "perceiver_encoder/~/self_attention_18/layer_norm_1:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_18/LayerNorm_1/bias",
    "perceiver_encoder/~/self_attention_18/layer_norm_1:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_18/LayerNorm_1/scale",
    "perceiver_encoder/~/self_attention_18/mlp/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_18/FeedForward_0/Dense_0/bias",
    "perceiver_encoder/~/self_attention_18/mlp/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_18/FeedForward_0/Dense_1/bias",
    "perceiver_encoder/~/self_attention_19/attention/linear_2:b": "params/PerceiverIO/Processor/SelfAttentionBlock_19/SelfAttention_0/value/bias",
    "perceiver_encoder/~/self_attention_19/attention/linear_3:b": "params/PerceiverIO/Processor/SelfAttentionBlock_19/SelfAttention_0/out/bias",
    "perceiver_encoder/~/self_attention_19/layer_norm:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_19/LayerNorm_0/bias",
    "perceiver_encoder/~/self_attention_19/layer_norm:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_19/LayerNorm_0/scale",
    "perceiver_encoder/~/self_attention_19/layer_norm_1:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_19/LayerNorm_1/bias",
    "perceiver_encoder/~/self_attention_19/layer_norm_1:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_19/LayerNorm_1/scale",
    "perceiver_encoder/~/self_attention_19/mlp/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_19/FeedForward_0/Dense_0/bias",
    "perceiver_encoder/~/self_attention_19/mlp/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_19/FeedForward_0/Dense_1/bias",
    "perceiver_encoder/~/self_attention_2/attention/linear_2:b": "params/PerceiverIO/Processor/SelfAttentionBlock_2/SelfAttention_0/value/bias",
    "perceiver_encoder/~/self_attention_2/attention/linear_3:b": "params/PerceiverIO/Processor/SelfAttentionBlock_2/SelfAttention_0/out/bias",
    "perceiver_encoder/~/self_attention_2/layer_norm:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_2/LayerNorm_0/bias",
    "perceiver_encoder/~/self_attention_2/layer_norm:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_2/LayerNorm_0/scale",
    "perceiver_encoder/~/self_attention_2/layer_norm_1:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_2/LayerNorm_1/bias",
    "perceiver_encoder/~/self_attention_2/layer_norm_1:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_2/LayerNorm_1/scale",
    "perceiver_encoder/~/self_attention_2/mlp/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_2/FeedForward_0/Dense_0/bias",
    "perceiver_encoder/~/self_attention_2/mlp/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_2/FeedForward_0/Dense_1/bias",
    "perceiver_encoder/~/self_attention_20/attention/linear_2:b": "params/PerceiverIO/Processor/SelfAttentionBlock_20/SelfAttention_0/value/bias",
    "perceiver_encoder/~/self_attention_20/attention/linear_3:b": "params/PerceiverIO/Processor/SelfAttentionBlock_20/SelfAttention_0/out/bias",
    "perceiver_encoder/~/self_attention_20/layer_norm:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_20/LayerNorm_0/bias",
    "perceiver_encoder/~/self_attention_20/layer_norm:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_20/LayerNorm_0/scale",
    "perceiver_encoder/~/self_attention_20/layer_norm_1:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_20/LayerNorm_1/bias",
    "perceiver_encoder/~/self_attention_20/layer_norm_1:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_20/LayerNorm_1/scale",
    "perceiver_encoder/~/self_attention_20/mlp/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_20/FeedForward_0/Dense_0/bias",
    "perceiver_encoder/~/self_attention_20/mlp/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_20/FeedForward_0/Dense_1/bias",
    "perceiver_encoder/~/self_attention_21/attention/linear_2:b": "params/PerceiverIO/Processor/SelfAttentionBlock_21/SelfAttention_0/value/bias",
    "perceiver_encoder/~/self_attention_21/attention/linear_3:b": "params/PerceiverIO/Processor/SelfAttentionBlock_21/SelfAttention_0/out/bias",
    "perceiver_encoder/~/self_attention_21/layer_norm:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_21/LayerNorm_0/bias",
    "perceiver_encoder/~/self_attention_21/layer_norm:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_21/LayerNorm_0/scale",
    "perceiver_encoder/~/self_attention_21/layer_norm_1:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_21/LayerNorm_1/bias",
    "perceiver_encoder/~/self_attention_21/layer_norm_1:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_21/LayerNorm_1/scale",
    "perceiver_encoder/~/self_attention_21/mlp/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_21/FeedForward_0/Dense_0/bias",
    "perceiver_encoder/~/self_attention_21/mlp/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_21/FeedForward_0/Dense_1/bias",
    "perceiver_encoder/~/self_attention_22/attention/linear_2:b": "params/PerceiverIO/Processor/SelfAttentionBlock_22/SelfAttention_0/value/bias",
    "perceiver_encoder/~/self_attention_22/attention/linear_3:b": "params/PerceiverIO/Processor/SelfAttentionBlock_22/SelfAttention_0/out/bias",
    "perceiver_encoder/~/self_attention_22/layer_norm:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_22/LayerNorm_0/bias",
    "perceiver_encoder/~/self_attention_22/layer_norm:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_22/LayerNorm_0/scale",
    "perceiver_encoder/~/self_attention_22/layer_norm_1:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_22/LayerNorm_1/bias",
    "perceiver_encoder/~/self_attention_22/layer_norm_1:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_22/LayerNorm_1/scale",
    "perceiver_encoder/~/self_attention_22/mlp/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_22/FeedForward_0/Dense_0/bias",
    "perceiver_encoder/~/self_attention_22/mlp/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_22/FeedForward_0/Dense_1/bias",
    "perceiver_encoder/~/self_attention_23/attention/linear_2:b": "params/PerceiverIO/Processor/SelfAttentionBlock_23/SelfAttention_0/value/bias",
    "perceiver_encoder/~/self_attention_23/attention/linear_3:b": "params/PerceiverIO/Processor/SelfAttentionBlock_23/SelfAttention_0/out/bias",
    "perceiver_encoder/~/self_attention_23/layer_norm:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_23/LayerNorm_0/bias",
    "perceiver_encoder/~/self_attention_23/layer_norm:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_23/LayerNorm_0/scale",
    "perceiver_encoder/~/self_attention_23/layer_norm_1:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_23/LayerNorm_1/bias",
    "perceiver_encoder/~/self_attention_23/layer_norm_1:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_23/LayerNorm_1/scale",
    "perceiver_encoder/~/self_attention_23/mlp/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_23/FeedForward_0/Dense_0/bias",
    "perceiver_encoder/~/self_attention_23/mlp/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_23/FeedForward_0/Dense_1/bias",
    "perceiver_encoder/~/self_attention_24/attention/linear_2:b": "params/PerceiverIO/Processor/SelfAttentionBlock_24/SelfAttention_0/value/bias",
    "perceiver_encoder/~/self_attention_24/attention/linear_3:b": "params/PerceiverIO/Processor/SelfAttentionBlock_24/SelfAttention_0/out/bias",
    "perceiver_encoder/~/self_attention_24/layer_norm:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_24/LayerNorm_0/bias",
    "perceiver_encoder/~/self_attention_24/layer_norm:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_24/LayerNorm_0/scale",
    "perceiver_encoder/~/self_attention_24/layer_norm_1:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_24/LayerNorm_1/bias",
    "perceiver_encoder/~/self_attention_24/layer_norm_1:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_24/LayerNorm_1/scale",
    "perceiver_encoder/~/self_attention_24/mlp/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_24/FeedForward_0/Dense_0/bias",
    "perceiver_encoder/~/self_attention_24/mlp/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_24/FeedForward_0/Dense_1/bias",
    "perceiver_encoder/~/self_attention_25/attention/linear_2:b": "params/PerceiverIO/Processor/SelfAttentionBlock_25/SelfAttention_0/value/bias",
    "perceiver_encoder/~/self_attention_25/attention/linear_3:b": "params/PerceiverIO/Processor/SelfAttentionBlock_25/SelfAttention_0/out/bias",
    "perceiver_encoder/~/self_attention_25/layer_norm:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_25/LayerNorm_0/bias",
    "perceiver_encoder/~/self_attention_25/layer_norm:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_25/LayerNorm_0/scale",
    "perceiver_encoder/~/self_attention_25/layer_norm_1:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_25/LayerNorm_1/bias",
    "perceiver_encoder/~/self_attention_25/layer_norm_1:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_25/LayerNorm_1/scale",
    "perceiver_encoder/~/self_attention_25/mlp/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_25/FeedForward_0/Dense_0/bias",
    "perceiver_encoder/~/self_attention_25/mlp/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_25/FeedForward_0/Dense_1/bias",
    "perceiver_encoder/~/self_attention_3/attention/linear_2:b": "params/PerceiverIO/Processor/SelfAttentionBlock_3/SelfAttention_0/value/bias",
    "perceiver_encoder/~/self_attention_3/attention/linear_3:b": "params/PerceiverIO/Processor/SelfAttentionBlock_3/SelfAttention_0/out/bias",
    "perceiver_encoder/~/self_attention_3/layer_norm:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_3/LayerNorm_0/bias",
    "perceiver_encoder/~/self_attention_3/layer_norm:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_3/LayerNorm_0/scale",
    "perceiver_encoder/~/self_attention_3/layer_norm_1:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_3/LayerNorm_1/bias",
    "perceiver_encoder/~/self_attention_3/layer_norm_1:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_3/LayerNorm_1/scale",
    "perceiver_encoder/~/self_attention_3/mlp/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_3/FeedForward_0/Dense_0/bias",
    "perceiver_encoder/~/self_attention_3/mlp/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_3/FeedForward_0/Dense_1/bias",
    "perceiver_encoder/~/self_attention_4/attention/linear_2:b": "params/PerceiverIO/Processor/SelfAttentionBlock_4/SelfAttention_0/value/bias",
    "perceiver_encoder/~/self_attention_4/attention/linear_3:b": "params/PerceiverIO/Processor/SelfAttentionBlock_4/SelfAttention_0/out/bias",
    "perceiver_encoder/~/self_attention_4/layer_norm:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_4/LayerNorm_0/bias",
    "perceiver_encoder/~/self_attention_4/layer_norm:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_4/LayerNorm_0/scale",
    "perceiver_encoder/~/self_attention_4/layer_norm_1:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_4/LayerNorm_1/bias",
    "perceiver_encoder/~/self_attention_4/layer_norm_1:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_4/LayerNorm_1/scale",
    "perceiver_encoder/~/self_attention_4/mlp/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_4/FeedForward_0/Dense_0/bias",
    "perceiver_encoder/~/self_attention_4/mlp/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_4/FeedForward_0/Dense_1/bias",
    "perceiver_encoder/~/self_attention_5/attention/linear_2:b": "params/PerceiverIO/Processor/SelfAttentionBlock_5/SelfAttention_0/value/bias",
    "perceiver_encoder/~/self_attention_5/attention/linear_3:b": "params/PerceiverIO/Processor/SelfAttentionBlock_5/SelfAttention_0/out/bias",
    "perceiver_encoder/~/self_attention_5/layer_norm:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_5/LayerNorm_0/bias",
    "perceiver_encoder/~/self_attention_5/layer_norm:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_5/LayerNorm_0/scale",
    "perceiver_encoder/~/self_attention_5/layer_norm_1:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_5/LayerNorm_1/bias",
    "perceiver_encoder/~/self_attention_5/layer_norm_1:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_5/LayerNorm_1/scale",
    "perceiver_encoder/~/self_attention_5/mlp/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_5/FeedForward_0/Dense_0/bias",
    "perceiver_encoder/~/self_attention_5/mlp/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_5/FeedForward_0/Dense_1/bias",
    "perceiver_encoder/~/self_attention_6/attention/linear_2:b": "params/PerceiverIO/Processor/SelfAttentionBlock_6/SelfAttention_0/value/bias",
    "perceiver_encoder/~/self_attention_6/attention/linear_3:b": "params/PerceiverIO/Processor/SelfAttentionBlock_6/SelfAttention_0/out/bias",
    "perceiver_encoder/~/self_attention_6/layer_norm:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_6/LayerNorm_0/bias",
    "perceiver_encoder/~/self_attention_6/layer_norm:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_6/LayerNorm_0/scale",
    "perceiver_encoder/~/self_attention_6/layer_norm_1:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_6/LayerNorm_1/bias",
    "perceiver_encoder/~/self_attention_6/layer_norm_1:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_6/LayerNorm_1/scale",
    "perceiver_encoder/~/self_attention_6/mlp/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_6/FeedForward_0/Dense_0/bias",
    "perceiver_encoder/~/self_attention_6/mlp/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_6/FeedForward_0/Dense_1/bias",
    "perceiver_encoder/~/self_attention_7/attention/linear_2:b": "params/PerceiverIO/Processor/SelfAttentionBlock_7/SelfAttention_0/value/bias",
    "perceiver_encoder/~/self_attention_7/attention/linear_3:b": "params/PerceiverIO/Processor/SelfAttentionBlock_7/SelfAttention_0/out/bias",
    "perceiver_encoder/~/self_attention_7/layer_norm:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_7/LayerNorm_0/bias",
    "perceiver_encoder/~/self_attention_7/layer_norm:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_7/LayerNorm_0/scale",
    "perceiver_encoder/~/self_attention_7/layer_norm_1:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_7/LayerNorm_1/bias",
    "perceiver_encoder/~/self_attention_7/layer_norm_1:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_7/LayerNorm_1/scale",
    "perceiver_encoder/~/self_attention_7/mlp/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_7/FeedForward_0/Dense_0/bias",
    "perceiver_encoder/~/self_attention_7/mlp/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_7/FeedForward_0/Dense_1/bias",
    "perceiver_encoder/~/self_attention_8/attention/linear_2:b": "params/PerceiverIO/Processor/SelfAttentionBlock_8/SelfAttention_0/value/bias",
    "perceiver_encoder/~/self_attention_8/attention/linear_3:b": "params/PerceiverIO/Processor/SelfAttentionBlock_8/SelfAttention_0/out/bias",
    "perceiver_encoder/~/self_attention_8/layer_norm:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_8/LayerNorm_0/bias",
    "perceiver_encoder/~/self_attention_8/layer_norm:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_8/LayerNorm_0/scale",
    "perceiver_encoder/~/self_attention_8/layer_norm_1:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_8/LayerNorm_1/bias",
    "perceiver_encoder/~/self_attention_8/layer_norm_1:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_8/LayerNorm_1/scale",
    "perceiver_encoder/~/self_attention_8/mlp/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_8/FeedForward_0/Dense_0/bias",
    "perceiver_encoder/~/self_attention_8/mlp/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_8/FeedForward_0/Dense_1/bias",
    "perceiver_encoder/~/self_attention_9/attention/linear_2:b": "params/PerceiverIO/Processor/SelfAttentionBlock_9/SelfAttention_0/value/bias",
    "perceiver_encoder/~/self_attention_9/attention/linear_3:b": "params/PerceiverIO/Processor/SelfAttentionBlock_9/SelfAttention_0/out/bias",
    "perceiver_encoder/~/self_attention_9/layer_norm:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_9/LayerNorm_0/bias",
    "perceiver_encoder/~/self_attention_9/layer_norm:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_9/LayerNorm_0/scale",
    "perceiver_encoder/~/self_attention_9/layer_norm_1:offset": "params/PerceiverIO/Processor/SelfAttentionBlock_9/LayerNorm_1/bias",
    "perceiver_encoder/~/self_attention_9/layer_norm_1:scale": "params/PerceiverIO/Processor/SelfAttentionBlock_9/LayerNorm_1/scale",
    "perceiver_encoder/~/self_attention_9/mlp/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_9/FeedForward_0/Dense_0/bias",
    "perceiver_encoder/~/self_attention_9/mlp/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_9/FeedForward_0/Dense_1/bias",
    "basic_decoder/~/trainable_position_encoding:pos_embs": "params/PerceiverIO/DecoderQueryEncoding/TrainablePositionalEncoding_0/positional_encoding",
    "trainable_position_encoding:pos_embs": "params/PerceiverIO/InputEncoding/Encoding_0/TrainablePositionalEncoding_0/positional_encoding",
    "perceiver_encoder/~/trainable_position_encoding:pos_embs": "params/PerceiverIO/EncodedQueryEncoding/TrainablePositionalEncoding_0/positional_encoding",
    "basic_decoder/cross_attention/attention/linear:b": "params/PerceiverIO/Decoder/CrossAttentionBlock_0/Attention_0/query/bias",
    "basic_decoder/cross_attention/attention/linear_1:b": "params/PerceiverIO/Decoder/CrossAttentionBlock_0/Attention_0/key/bias",
    "perceiver_encoder/~/cross_attention/attention/linear:b": "params/PerceiverIO/Encoder/CrossAttentionBlock_0/Attention_0/query/bias",
    "perceiver_encoder/~/cross_attention/attention/linear_1:b": "params/PerceiverIO/Encoder/CrossAttentionBlock_0/Attention_0/key/bias",
    "perceiver_encoder/~/self_attention/attention/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_0/SelfAttention_0/query/bias",
    "perceiver_encoder/~/self_attention/attention/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_0/SelfAttention_0/key/bias",
    "perceiver_encoder/~/self_attention_1/attention/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_1/SelfAttention_0/query/bias",
    "perceiver_encoder/~/self_attention_1/attention/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_1/SelfAttention_0/key/bias",
    "perceiver_encoder/~/self_attention_10/attention/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_10/SelfAttention_0/query/bias",
    "perceiver_encoder/~/self_attention_10/attention/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_10/SelfAttention_0/key/bias",
    "perceiver_encoder/~/self_attention_11/attention/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_11/SelfAttention_0/query/bias",
    "perceiver_encoder/~/self_attention_11/attention/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_11/SelfAttention_0/key/bias",
    "perceiver_encoder/~/self_attention_12/attention/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_12/SelfAttention_0/query/bias",
    "perceiver_encoder/~/self_attention_12/attention/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_12/SelfAttention_0/key/bias",
    "perceiver_encoder/~/self_attention_13/attention/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_13/SelfAttention_0/query/bias",
    "perceiver_encoder/~/self_attention_13/attention/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_13/SelfAttention_0/key/bias",
    "perceiver_encoder/~/self_attention_14/attention/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_14/SelfAttention_0/query/bias",
    "perceiver_encoder/~/self_attention_14/attention/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_14/SelfAttention_0/key/bias",
    "perceiver_encoder/~/self_attention_15/attention/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_15/SelfAttention_0/query/bias",
    "perceiver_encoder/~/self_attention_15/attention/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_15/SelfAttention_0/key/bias",
    "perceiver_encoder/~/self_attention_16/attention/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_16/SelfAttention_0/query/bias",
    "perceiver_encoder/~/self_attention_16/attention/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_16/SelfAttention_0/key/bias",
    "perceiver_encoder/~/self_attention_17/attention/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_17/SelfAttention_0/query/bias",
    "perceiver_encoder/~/self_attention_17/attention/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_17/SelfAttention_0/key/bias",
    "perceiver_encoder/~/self_attention_18/attention/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_18/SelfAttention_0/query/bias",
    "perceiver_encoder/~/self_attention_18/attention/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_18/SelfAttention_0/key/bias",
    "perceiver_encoder/~/self_attention_19/attention/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_19/SelfAttention_0/query/bias",
    "perceiver_encoder/~/self_attention_19/attention/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_19/SelfAttention_0/key/bias",
    "perceiver_encoder/~/self_attention_2/attention/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_2/SelfAttention_0/query/bias",
    "perceiver_encoder/~/self_attention_2/attention/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_2/SelfAttention_0/key/bias",
    "perceiver_encoder/~/self_attention_20/attention/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_20/SelfAttention_0/query/bias",
    "perceiver_encoder/~/self_attention_20/attention/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_20/SelfAttention_0/key/bias",
    "perceiver_encoder/~/self_attention_21/attention/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_21/SelfAttention_0/query/bias",
    "perceiver_encoder/~/self_attention_21/attention/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_21/SelfAttention_0/key/bias",
    "perceiver_encoder/~/self_attention_22/attention/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_22/SelfAttention_0/query/bias",
    "perceiver_encoder/~/self_attention_22/attention/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_22/SelfAttention_0/key/bias",
    "perceiver_encoder/~/self_attention_23/attention/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_23/SelfAttention_0/query/bias",
    "perceiver_encoder/~/self_attention_23/attention/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_23/SelfAttention_0/key/bias",
    "perceiver_encoder/~/self_attention_24/attention/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_24/SelfAttention_0/query/bias",
    "perceiver_encoder/~/self_attention_24/attention/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_24/SelfAttention_0/key/bias",
    "perceiver_encoder/~/self_attention_25/attention/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_25/SelfAttention_0/query/bias",
    "perceiver_encoder/~/self_attention_25/attention/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_25/SelfAttention_0/key/bias",
    "perceiver_encoder/~/self_attention_3/attention/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_3/SelfAttention_0/query/bias",
    "perceiver_encoder/~/self_attention_3/attention/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_3/SelfAttention_0/key/bias",
    "perceiver_encoder/~/self_attention_4/attention/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_4/SelfAttention_0/query/bias",
    "perceiver_encoder/~/self_attention_4/attention/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_4/SelfAttention_0/key/bias",
    "perceiver_encoder/~/self_attention_5/attention/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_5/SelfAttention_0/query/bias",
    "perceiver_encoder/~/self_attention_5/attention/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_5/SelfAttention_0/key/bias",
    "perceiver_encoder/~/self_attention_6/attention/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_6/SelfAttention_0/query/bias",
    "perceiver_encoder/~/self_attention_6/attention/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_6/SelfAttention_0/key/bias",
    "perceiver_encoder/~/self_attention_7/attention/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_7/SelfAttention_0/query/bias",
    "perceiver_encoder/~/self_attention_7/attention/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_7/SelfAttention_0/key/bias",
    "perceiver_encoder/~/self_attention_8/attention/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_8/SelfAttention_0/query/bias",
    "perceiver_encoder/~/self_attention_8/attention/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_8/SelfAttention_0/key/bias",
    "perceiver_encoder/~/self_attention_9/attention/linear:b": "params/PerceiverIO/Processor/SelfAttentionBlock_9/SelfAttention_0/query/bias",
    "perceiver_encoder/~/self_attention_9/attention/linear_1:b": "params/PerceiverIO/Processor/SelfAttentionBlock_9/SelfAttention_0/key/bias",
    "embed:embeddings": "params/EmbeddingEncoder/embedding",
    "embedding_decoder:bias": "params/PerceiverIO/OutputDecoding/Decoding_0/EmbedDecoding_0/bias",
    "perceiver_encoder/~/cross_attention/attention/linear_2:w": "params/PerceiverIO/Encoder/CrossAttentionBlock_0/Attention_0/value/kernel",
    "basic_decoder/cross_attention/attention/linear:w": "params/PerceiverIO/Decoder/CrossAttentionBlock_0/Attention_0/query/kernel",
    "perceiver_encoder/~/cross_attention/attention/linear_1:w": "params/PerceiverIO/Encoder/CrossAttentionBlock_0/Attention_0/key/kernel",
    "basic_decoder/cross_attention/attention/linear_3:w": "params/PerceiverIO/Decoder/CrossAttentionBlock_0/Attention_0/out/kernel",
    "basic_decoder/cross_attention/mlp/linear:w": "params/PerceiverIO/Decoder/CrossAttentionBlock_0/FeedForward_0/Dense_0/kernel",
    "basic_decoder/cross_attention/mlp/linear_1:w": "params/PerceiverIO/Decoder/CrossAttentionBlock_0/FeedForward_0/Dense_1/kernel",
    "basic_decoder/cross_attention/attention/linear_2:b": "params/PerceiverIO/Decoder/CrossAttentionBlock_0/Attention_0/value/bias",
    "basic_decoder/cross_attention/attention/linear_3:b": "params/PerceiverIO/Decoder/CrossAttentionBlock_0/Attention_0/out/bias",
    "basic_decoder/cross_attention/layer_norm:offset": "params/PerceiverIO/Decoder/CrossAttentionBlock_0/LayerNorm_0/bias",
    "basic_decoder/cross_attention/layer_norm:scale": "params/PerceiverIO/Decoder/CrossAttentionBlock_0/LayerNorm_0/scale",
    "basic_decoder/cross_attention/layer_norm_2:offset": "params/PerceiverIO/Decoder/CrossAttentionBlock_0/LayerNorm_2/bias",
    "basic_decoder/cross_attention/layer_norm_2:scale": "params/PerceiverIO/Decoder/CrossAttentionBlock_0/LayerNorm_2/scale",
    "basic_decoder/cross_attention/mlp/linear:b": "params/PerceiverIO/Decoder/CrossAttentionBlock_0/FeedForward_0/Dense_0/bias",
    "basic_decoder/cross_attention/mlp/linear_1:b": "params/PerceiverIO/Decoder/CrossAttentionBlock_0/FeedForward_0/Dense_1/bias",
    "perceiver_encoder/~/cross_attention/layer_norm_1:offset": "params/PerceiverIO/Encoder/CrossAttentionBlock_0/LayerNorm_1/bias",
    "perceiver_encoder/~/cross_attention/layer_norm_1:scale": "params/PerceiverIO/Encoder/CrossAttentionBlock_0/LayerNorm_1/scale",
}

def reshape_attention_kernel(weights, n_heads=8):
    d_inputs, d_hidden = weights.shape
    d_head_hidden = d_hidden // n_heads
    return jnp.reshape(weights, (d_inputs, n_heads, d_head_hidden))

def reshape_attention_bias(weights, n_heads=8):
    d_hidden, = weights.shape
    d_head_hidden = d_hidden // n_heads
    return jnp.reshape(weights, (n_heads, d_head_hidden))

def variables(path):
    with open(path, "rb") as f:
        original_params = pickle.loads(f.read())

    flat_initial_variables = {}
    for parent_key, parent_value in hk.data_structures.to_immutable_dict(original_params).items():
        for key, weights in hk.data_structures.to_immutable_dict(parent_value).items():
            full_key = f"{parent_key}:{key}"
            mapped_full_key = tuple(PARAM_MAP[full_key].split("/"))

            if (("query" in mapped_full_key)
                or ("key" in mapped_full_key)
                or ("value" in mapped_full_key)):

                if "kernel" in mapped_full_key:
                    flat_initial_variables[mapped_full_key] = reshape_attention_kernel(weights)

                if "bias" in mapped_full_key:
                    flat_initial_variables[mapped_full_key] = reshape_attention_bias(weights)

            else:
                flat_initial_variables[mapped_full_key] = weights

    return freeze(unflatten_dict(flat_initial_variables))
